# 4_文件子系统

## 4.1 linux文件结构

### 什么是虚拟文件系统

虚拟文件系统（VFS）是物理文件系统与服务之间的一个接口层，它对Linux的每个文件系统的所有细节进行抽象，使得不同的文件系统在Linux核心以及系统中运行的其他进程看来，都是相同的。严格来说，VFS并不是一种实际的文件系统。它只存在于内存中，不存在于任何外存空间，是一种逻辑存储结构（要明白什么是逻辑结构，什么是物理结构）。VFS在系统启动时建立，在系统关闭时消亡。

### 根目录下目录介绍

首先，linux系统是一个树形结构，根目录作为根节点，然后以树的形式向下创建文件。我们`cd /`到根目录下，有如下几个目录。

`bin`：binary，表示可执行程序。

`dev`：device，设备文件。

`home`：普通用户家目录的根目录。

`root`：root用户的家目录。

`sbin`：system binary，和系统相关的可执行程序。

`var`：variable，经常发生变化的文件，比如日志文件。

`etc`：配置文件。

`lib`：库文件。

`proc`：process，进程映射文件。

`boot`：启动配置文件，包含引导加载程序相关的文件。

`usr`：包含大部分用户都能访问的应用程序和文件。



## 4.2 当前工作目录

`pwd`命令显示shell这个进程的当前工作目录。



## 4.3 cd命令

`cd`命令，改变当前工作目录。

`cd /`切换到根目录

`cd ~`切换到该用户的家目录

`cd .`切换到当前目录

`cd ..`切换到上一级目录

`cd -`回到上一次目录，这里通过`env`命令，查看环境变量，其中有个`OLDPWD`变量，记录了上次切换的目录情况。

`cd 目录`到该目录下



## 4.4 mkdir命令

`mkdir`命令，表示创建目录，如果它不存在的话。

使用方法为`mkdir [选项] 目录名`

### 常用mkdir选项介绍

`-m 3位八进制数` ，表示在创建的时候指定目录的权限。

`mkdir -p`，表示在创建的时候如果这个指定的路径没有，则会创建该路径下的所有目录，即迭代创建。如`mkdir -p /root/test/a`，如果root目录下没有test目录，则会创建test，然后再在其目录下创建a。

`mkdir -v`，输出一行信息来提示创建了该目录

注：mkdir可以同时创建多个目录，选项之间是可以组合使用的。



## 4.5 rmdir命令

`rmdir`命令，表示删除目录，如果它存在的话。

使用方法为`rmdir [选项] 目录名`

### 常用rmdir选项介绍

如果不加选项的情况下，只能删除空目录。

`-v`，输出一行信息来提示删除了该目录

`-p`，表示迭代删除这个指定路径下的所有目录，如`rmdir -p test/a`，表示删除test目录，也删除a目录。但是只能删除空目录。

注：rmdir可以同时删除多个目录，选项之间是可以组合使用的。



## 4.6 ls命令

`ls`列举目录内容。

使用方式`ls [选项] [FILE]`

`ls -a`，显示该目录下的所有文件，包括.和..。

`ls -l`，显示该目录下的所有文件的详细信息。

`ls -h`，以人类易看懂的方式显示文件信息。

`ls -i`，显示该目录下的所有文件inode号。

其他命令用man手册查看`man ls`。



## 4.7 cp命令

`cp`命令，可以拷贝文件和目录。

```shell
使用方法：`cp [选项] 源文件 目标路径|目标文件`
# 当目标是目录的时候，cp命令会直接在目标目录下拷贝一份副本，文件名和源文件一致
# 当目标是文件的时候，cp命令会拷贝源文件的内容，重命名为目标文件的名字
```

在Ubuntu当中，如果cp命令中目标路径已存在同名文件，那么就会直接覆盖原有的文件内容。

如果希望在覆盖之间进行警告，则应该在选项中添加-i(interactive 交互式)。

如果源文件是一个目录，那么在选项中必须要添加-r(recursive)，表示循环递归，也就是说添加-r以后，cp命令会递归地将目录下的所有文件都进行拷贝。

如果希望拷贝之前不提示的话，就可以用-f强制拷贝。



## 4.8 mv命令

使用mv命令可以移动文件或者目录

`mv [选项] 源文件 目标路径|目标文件`

- 执行mv命令的效果和Windows下的剪切-->粘贴的效果一样
- 和cp命令一样，mv命令会出现覆盖现存文件的情况，也可以使用-f或者-i选项来关闭或者开启提醒
- Linux里面没有专门的重命名命令，使用mv命令移动到原来的目录下面就可以实现重命名了



## 4.9 rm命令

`rm`命令可以删除文件和目录

`rm [选项] 文件|目录`

- 使用rm，cp和mv导致文件被覆盖或者删除都是**不可恢复**的！
- 不要以root的身份或者是sudo权限来执行rm -rf，这回造成不可恢复的后果
- 和mv和cp命令一样，rm也可以使用-f选项来实现强制删除，使用-i选项来实现删除前交互提示，使用-r选项来实现递归删除目录及目录下文件，使用-f选项来忽略提示。



## 4.10 tree命令

使用tree命令可以以树状形式查看指定路径下的文件。

首次使用之前需要先安装tree

`sudo apt install tree`

使用tree命令就可以显示目录的树状结构

`tree 路径名`



