# 6_文件查找

## locate命令

系统默认是没有的，需要安装`apt install mlocate`

`locate`命令用于查找符合条件的文档，它会去保存文档和目录名称的数据库里查找合乎范本样式条件的文档或目录。

使用方法：`locate fileName`,具体使用见`man locate`。

注：如果刚创建的文件，使用locate命令去查找，可能会查找不到，因为这个文件名还没有更新到其数据库里。



## which命令

`which`命令是找一个可执行程序。如查找ls命令，`which ls`，显示在`/usr/bin/ls`。



## find命令

### 索引的概念

- 在Windows的旧版本中，想要搜索一个文件是非常缓慢的。为了实现快速查找，在Windows 10和Linux系统当中，系统会专门维护一个索引文件。
- 在Linux当中，索引文件是存放在具体的磁盘文件前面的，索引文件里面存放了各个文件的位置信息和其他信息。

使用`find`命令可以根据查找条件来在起始目录下来查找文件，然后再执行指定的操作。



### find命令的使用

`find 起始目录 查找条件 操作`。如`find . -name *.c`。注意会迭代查询

- 常用的操作

|       查找条件 操作       |                             解释                             |
| :-----------------------: | :----------------------------------------------------------: |
|       -name '字串'        | 查找文件名字匹配所给字串的所有文件，字串内可以通配符*、?、[] |
|          -type x          |                      查找类型为x的文件                       |
| -size [+\|-]n[b\|c\|k\|w] | 查找指定文件大小的文件，n前面+表示大于，-表示小于；n后面的字符表示单位，缺省为b，代表512字节的块 |
|        -perm 权限         |    查找具有指定权限的文件和目录，权限的表示是3位八进制数     |
|        -uid/gid n         | uid:用户，gid：用户组；表示查找数据ID号位n的uid/gid的所有文件 |
|    -group/user '字串'     | group：用户组名，user：用户名；表示查找属于group/user为字串的所有的文件 |
|          -empty           | 查找空目录，因为空目录默认大小为4096B，如果要查找空目录该用这个 |



- 根据时间查找

| 查找条件 操作 |                             解释                             |
| :-----------: | :----------------------------------------------------------: |
|    amin n     | 查找n分钟以前被访问过的所有文件（+表示n分钟之前，-表示n分钟之内，+号和-号都不能省略） |
|    cmin n     |           查找n分钟以前文件状态被修改过的所有文件            |
|    mmin n     |           查找n分钟以前文件内容被修改过的所有文件            |
|    atime n    |                查找n天以前被访问过的所有文件                 |
|    ctime n    |            查找n天以前文件状态被修改过的所有文件             |
|    mtime n    |            查找n天以前文件内容被修改过的所有文件             |



### 查找条件的运算

查找条件可以进行逻辑运算，如逻辑与，逻辑或，逻辑非。

| 逻辑运算 | 查找条件 |                     解释                     |
| :------: | :------: | :------------------------------------------: |
|  逻辑与  |    -a    | 表示只有当所给的条件都满足时，查找条件才满足 |
|  逻辑或  |    -o    | 表示只要所给的条件有一个满足，查找条件就满足 |
|  逻辑非  |    !     |         表示查找不满足所给条件的文件         |

```shell
find . -name “*.c” -a -size +40c
# 表示在当前目录下查找到文件大小大于40字节的所有*.c文件
```



### 应用通配符

通配符(wildcard)是字符串里面的特殊符号，如果将字符串里面的通配符按照一定的规则用字符串来替换以后，得到的字符串和目标字符串一致，那么目标字符串就能匹配。

|   模式   |                解释                 |
| :------: | :---------------------------------: |
|    *     | 可以匹配任意多个字符（包括0个字符） |
|    ？    |        可以匹配任意一个字符         |
|  [字符]  |  匹配集合内的任意一个字符，如[abc]  |
| [!字符]  | 匹配集合外的任意一个字符，如[!abc]  |
|  [0-9]   |      匹配集合内的任意一个数字       |
|  [a-z]   |    匹配集合内的任意一个小写字母     |
| [A-Za-z] |      匹配集合内的任意一个字母       |



## 组合操作

在find命令后面添加`-exec 新命令 \;`就可以对每个查找出来的文件执行新命令

`find /usr/include -name stdio.h -exec ls -l {} \;`





